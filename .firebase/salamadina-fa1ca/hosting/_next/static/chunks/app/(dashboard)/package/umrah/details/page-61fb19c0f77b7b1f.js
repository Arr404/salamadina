(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3169],{19732:function(e,a,t){Promise.resolve().then(t.bind(t,64393))},64393:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return q}});var i=t(57437),r=t(2265),l=t(16463),n=t(91326),s=t(40468),d=t(62197),c=t(28027),o=t(83719),u=t(28549),h=t(56065),g=t(46849),m=t(91651),p=t(76520),x=t(55205),v=t(33037),y=t(84161),f=t(97183),j=t(23983),k=t(60335),Z=t(76548),b=t(14595),I=t(19847),P=t(62373),E=t(69842),D=t(73501);let w=(0,E.ad)(D.Z),C={init(){return this},getPackageDetails:async e=>{try{let a=(0,E.IO)((0,E.hJ)(w,"packageDetails"),(0,E.ar)("packageId","==",e)),t=await (0,E.PL)(a);if(t.empty)return null;let i=t.docs[0];return{id:i.id,...i.data()}}catch(e){throw console.error("Error fetching package details: ",e),Error("Failed to fetch package details")}},getDetailsById:async e=>{try{let a=(0,E.JU)(w,"packageDetails",e),t=await (0,E.QT)(a);if(!t.exists())return null;return{id:t.id,...t.data()}}catch(e){throw console.error("Error fetching package details by ID: ",e),Error("Failed to fetch package details")}},addPackageDetails:async e=>{try{if(C.init(),await C.getPackageDetails(e.packageId))throw Error("Details for this package already exist");let a=C.sanitizeDetailsData(e);return(await (0,E.ET)((0,E.hJ)(w,"packageDetails"),{...a,createdAt:E.EK.now()})).id}catch(e){if(console.error("Error adding package details: ",e),e instanceof Error)throw e;throw Error("Failed to add package details")}},updatePackageDetails:async(e,a)=>{try{if(!e)throw Error("Details ID is required");C.init();let t=C.sanitizeDetailsData(a),i=(0,E.JU)(w,"packageDetails",e);await (0,E.r7)(i,{...t,updatedAt:E.EK.now()}),console.log("Package details ".concat(e," updated successfully"))}catch(e){if(console.error("Error updating package details: ",e),e instanceof Error)throw Error("Failed to update package details: ".concat(e.message));throw Error("Failed to update package details")}},deletePackageDetails:async e=>{try{await (0,E.oe)((0,E.JU)(w,"packageDetails",e))}catch(e){throw console.error("Error deleting package details: ",e),Error("Failed to delete package details")}},sanitizeDetailsData(e){let a={};return void 0!==e.packageId&&(a.packageId=e.packageId),void 0!==e.airline&&(a.airline=e.airline||""),void 0!==e.peopleInRoom&&(a.peopleInRoom=e.peopleInRoom||""),void 0!==e.duration&&(a.duration=e.duration||""),void 0!==e.departureDate&&(a.departureDate=e.departureDate||""),void 0!==e.nextManasik&&(a.nextManasik=e.nextManasik||""),void 0!==e.includedItems&&(a.includedItems=Array.isArray(e.includedItems)?e.includedItems.map(e=>e||""):[]),void 0!==e.excludedItems&&(a.excludedItems=Array.isArray(e.excludedItems)?e.excludedItems.map(e=>e||""):[]),void 0!==e.requirements&&(a.requirements=Array.isArray(e.requirements)?e.requirements.map(e=>e||""):[]),void 0!==e.terms&&(a.terms=Array.isArray(e.terms)?e.terms.map(e=>e||""):[]),void 0!==e.hotels&&(a.hotels=Array.isArray(e.hotels)?e.hotels.map(e=>({city:e.city||"",name:e.name||"",distance:e.distance||"",rating:"number"==typeof e.rating?e.rating:0,mapUrl:e.mapUrl||""})):[]),void 0!==e.itinerary&&(a.itinerary=Array.isArray(e.itinerary)?e.itinerary.map(e=>({day:"number"==typeof e.day?e.day:0,title:e.title||"",description:e.description||"",activities:Array.isArray(e.activities)?e.activities.map(e=>e||""):[]})):[]),void 0!==e.facilities&&(a.facilities=Array.isArray(e.facilities)?e.facilities.map(e=>({title:e.title||"",description:e.description||""})):[]),void 0!==e.additionalInformation&&(a.additionalInformation=e.additionalInformation||""),a}};var A=t(26457);function W(e){let{children:a,value:t,index:r,...l}=e;return(0,i.jsx)("div",{role:"tabpanel",hidden:t!==r,id:"package-details-tabpanel-".concat(r),"aria-labelledby":"package-details-tab-".concat(r),...l,children:t===r&&(0,i.jsx)(n.Z,{sx:{p:3},children:a})})}function F(e){return{id:"package-details-tab-".concat(e),"aria-controls":"package-details-tabpanel-".concat(e)}}let S={packageId:"",airline:"",peopleInRoom:"",duration:"",departureDate:"",nextManasik:"",includedItems:[""],excludedItems:[""],hotels:[{city:"",name:"",distance:"",rating:0,mapUrl:""}],itinerary:[{day:1,title:"",description:"",activities:[""]}],requirements:[""],terms:[""],facilities:[{title:"",description:""}],additionalInformation:""};function U(e){var a,t,E,D,w;let{packageId:U}=e,q=(0,l.useRouter)(),[R,M]=(0,r.useState)(0),[J,T]=(0,r.useState)(!0),[H,B]=(0,r.useState)(!1),[N,_]=(0,r.useState)({open:!1,message:"",type:"success"}),[z,K]=(0,r.useState)(S),[L,O]=(0,r.useState)(null),[Q,V]=(0,r.useState)(null),[X,Y]=(0,r.useState)([]);(0,r.useEffect)(()=>{(async()=>{try{T(!0);let e=await A.p.getPackages();if(Y(e),U){let a=e.find(e=>e.id===U);if(a){O(a),K(e=>({...e,packageId:U}));let e=await C.getPackageDetails(U);e&&(K(e),V(e.id||null))}}}catch(e){console.error("Error fetching data:",e),G("Error loading data","error")}finally{T(!1)}})()},[U]);let G=(e,a)=>{_({open:!0,message:e,type:a})},$=(e,a)=>{K(t=>({...t,[e]:a}))},ee=(e,a,t)=>{K(i=>{let r=[...i[e]];return r[a]=t,{...i,[e]:r}})},ea=e=>{K(a=>{let t=[...a[e],""];return{...a,[e]:t}})},et=(e,a)=>{K(t=>{let i=[...t[e]];return i.splice(a,1),{...t,[e]:i}})},ei=(e,a,t)=>{K(i=>{let r=[...i.hotels];return r[e]={...r[e],[a]:t},{...i,hotels:r}})},er=e=>{K(a=>{let t=[...a.hotels];return t.splice(e,1),{...a,hotels:t}})},el=(e,a,t)=>{K(i=>{let r=[...i.itinerary];return r[e]={...r[e],[a]:t},{...i,itinerary:r}})},en=(e,a,t)=>{K(i=>{let r=[...i.itinerary],l=[...r[e].activities||[]];return l[a]=t,r[e]={...r[e],activities:l},{...i,itinerary:r}})},es=e=>{K(a=>{let t=[...a.itinerary],i=[...t[e].activities||[],""];return t[e]={...t[e],activities:i},{...a,itinerary:t}})},ed=(e,a)=>{K(t=>{let i=[...t.itinerary],r=[...i[e].activities||[]];return r.splice(a,1),i[e]={...i[e],activities:r},{...t,itinerary:i}})},ec=e=>{K(a=>{let t=[...a.itinerary];return t.splice(e,1),{...a,itinerary:t.map((e,a)=>({...e,day:a+1}))}})},eo=(e,a,t)=>{K(i=>{let r=[...i.facilities];return r[e]={...r[e],[a]:t},{...i,facilities:r}})},eu=e=>{K(a=>{let t=[...a.facilities];return t.splice(e,1),{...a,facilities:t}})},eh=async e=>{e.preventDefault(),B(!0);try{if(!z.packageId)throw Error("Package ID is required");if(Q)await C.updatePackageDetails(Q,z),G("Package details updated successfully","success");else{let e=await C.addPackageDetails(z);V(e),G("Package details created successfully","success")}setTimeout(()=>{q.push("/admin/packages/".concat(z.packageId,"/details"))},2e3)}catch(a){console.error("Error saving package details:",a);let e="Failed to save package details";a instanceof Error&&(e+=": ".concat(a.message)),G(e,"error")}finally{B(!1)}},eg=async e=>{try{T(!0),K({...S,packageId:e}),V(null);let a=X.find(a=>a.id===e);O(a||null);let t=await C.getPackageDetails(e);t&&(K(t),V(t.id||null)),q.push("/admin/packages/".concat(e,"/edit-details"))}catch(e){console.error("Error changing package:",e),G("Error loading package details","error")}finally{T(!1)}};return J?(0,i.jsx)(n.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"80vh"},children:(0,i.jsx)(s.Z,{})}):(0,i.jsx)(d.Z,{maxWidth:"lg",sx:{mt:4,mb:8},children:(0,i.jsxs)(c.Z,{sx:{p:3,mb:4},children:[(0,i.jsx)(o.Z,{variant:"h4",component:"h1",gutterBottom:!0,children:Q?"Edit Package Details":"Create Package Details"}),(0,i.jsxs)(u.Z,{fullWidth:!0,sx:{mb:3},children:[(0,i.jsx)(h.Z,{id:"package-select-label",children:"Package"}),(0,i.jsx)(g.Z,{labelId:"package-select-label",value:z.packageId,label:"Package",onChange:e=>eg(e.target.value),children:null==X?void 0:X.map(e=>(0,i.jsx)(m.Z,{value:e.id,children:e.title},e.id))})]}),L&&(0,i.jsx)(p.Z,{sx:{mb:3},children:(0,i.jsx)(x.Z,{children:(0,i.jsxs)(v.ZP,{container:!0,spacing:2,children:[(0,i.jsxs)(v.ZP,{item:!0,xs:12,md:8,children:[(0,i.jsx)(o.Z,{variant:"h6",children:L.title}),(0,i.jsx)(o.Z,{variant:"body2",color:"text.secondary",children:L.subtitle})]}),(0,i.jsxs)(v.ZP,{item:!0,xs:12,md:4,children:[(0,i.jsxs)(o.Z,{variant:"body2",align:"right",children:["Price: IDR ",L.price.toLocaleString("id-ID")]}),(0,i.jsxs)(o.Z,{variant:"body2",align:"right",children:["Seats: ",L.seatsLeft,"/",L.totalSeats]})]})]})})}),(0,i.jsxs)("form",{onSubmit:eh,children:[(0,i.jsx)(n.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,i.jsxs)(y.Z,{value:R,onChange:(e,a)=>{M(a)},"aria-label":"package details tabs",children:[(0,i.jsx)(f.Z,{label:"Basic Info",...F(0)}),(0,i.jsx)(f.Z,{label:"Inclusions & Exclusions",...F(1)}),(0,i.jsx)(f.Z,{label:"Hotels",...F(2)}),(0,i.jsx)(f.Z,{label:"Itinerary",...F(3)}),(0,i.jsx)(f.Z,{label:"Requirements & Terms",...F(4)}),(0,i.jsx)(f.Z,{label:"Facilities",...F(5)})]})}),(0,i.jsx)(W,{value:R,index:0,children:(0,i.jsxs)(v.ZP,{container:!0,spacing:3,children:[(0,i.jsx)(v.ZP,{item:!0,xs:12,md:6,children:(0,i.jsx)(j.Z,{fullWidth:!0,label:"Airline",value:z.airline,onChange:e=>$("airline",e.target.value),margin:"normal"})}),(0,i.jsx)(v.ZP,{item:!0,xs:12,md:6,children:(0,i.jsx)(j.Z,{fullWidth:!0,label:"People In Room",value:z.peopleInRoom,onChange:e=>$("peopleInRoom",e.target.value),margin:"normal",placeholder:"e.g. Quad (4 orang/kamar)"})}),(0,i.jsx)(v.ZP,{item:!0,xs:12,md:6,children:(0,i.jsx)(j.Z,{fullWidth:!0,label:"Duration",value:z.duration,onChange:e=>$("duration",e.target.value),margin:"normal",placeholder:"e.g. 9 Hari"})}),(0,i.jsx)(v.ZP,{item:!0,xs:12,md:6,children:(0,i.jsx)(j.Z,{fullWidth:!0,label:"Departure Date",value:z.departureDate,onChange:e=>$("departureDate",e.target.value),margin:"normal",placeholder:"e.g. 15 April 2025"})}),(0,i.jsx)(v.ZP,{item:!0,xs:12,md:6,children:(0,i.jsx)(j.Z,{fullWidth:!0,label:"Next Manasik Date",value:z.nextManasik,onChange:e=>$("nextManasik",e.target.value),margin:"normal",placeholder:"e.g. 1 April 2025"})}),(0,i.jsx)(v.ZP,{item:!0,xs:12,children:(0,i.jsx)(j.Z,{fullWidth:!0,multiline:!0,rows:4,label:"Additional Information",value:z.additionalInformation||"",onChange:e=>$("additionalInformation",e.target.value),margin:"normal"})})]})}),(0,i.jsxs)(W,{value:R,index:1,children:[(0,i.jsx)(o.Z,{variant:"h6",gutterBottom:!0,children:"Included Items"}),null==z?void 0:null===(a=z.includedItems)||void 0===a?void 0:a.map((e,a)=>(0,i.jsxs)(n.Z,{sx:{display:"flex",mb:2},children:[(0,i.jsx)(j.Z,{fullWidth:!0,label:"Item ".concat(a+1),value:e,onChange:e=>ee("includedItems",a,e.target.value),margin:"normal"}),(0,i.jsx)(k.Z,{onClick:()=>et("includedItems",a),disabled:z.includedItems.length<=1,children:(0,i.jsx)(I.Z,{})})]},"included-".concat(a))),(0,i.jsx)(Z.Z,{startIcon:(0,i.jsx)(P.Z,{}),onClick:()=>ea("includedItems"),sx:{mb:4},children:"Add Included Item"}),(0,i.jsx)(b.Z,{sx:{my:3}}),(0,i.jsx)(o.Z,{variant:"h6",gutterBottom:!0,children:"Excluded Items"}),null==z?void 0:null===(t=z.excludedItems)||void 0===t?void 0:t.map((e,a)=>(0,i.jsxs)(n.Z,{sx:{display:"flex",mb:2},children:[(0,i.jsx)(j.Z,{fullWidth:!0,label:"Item ".concat(a+1),value:e,onChange:e=>ee("excludedItems",a,e.target.value),margin:"normal"}),(0,i.jsx)(k.Z,{onClick:()=>et("excludedItems",a),disabled:z.excludedItems.length<=1,children:(0,i.jsx)(I.Z,{})})]},"excluded-".concat(a))),(0,i.jsx)(Z.Z,{startIcon:(0,i.jsx)(P.Z,{}),onClick:()=>ea("excludedItems"),children:"Add Excluded Item"})]}),(0,i.jsxs)(W,{value:R,index:2,children:[null==z?void 0:null===(E=z.hotels)||void 0===E?void 0:E.map((e,a)=>(0,i.jsxs)(c.Z,{sx:{p:3,mb:3},children:[(0,i.jsxs)(n.Z,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:[(0,i.jsxs)(o.Z,{variant:"h6",children:["Hotel ",a+1]}),(0,i.jsx)(k.Z,{onClick:()=>er(a),disabled:z.hotels.length<=1,children:(0,i.jsx)(I.Z,{})})]}),(0,i.jsxs)(v.ZP,{container:!0,spacing:3,children:[(0,i.jsx)(v.ZP,{item:!0,xs:12,md:6,children:(0,i.jsx)(j.Z,{fullWidth:!0,label:"City",value:e.city,onChange:e=>ei(a,"city",e.target.value),margin:"normal",placeholder:"e.g. Makkah"})}),(0,i.jsx)(v.ZP,{item:!0,xs:12,md:6,children:(0,i.jsx)(j.Z,{fullWidth:!0,label:"Hotel Name",value:e.name,onChange:e=>ei(a,"name",e.target.value),margin:"normal",placeholder:"e.g. Azka Al Safa Hotel"})}),(0,i.jsx)(v.ZP,{item:!0,xs:12,md:6,children:(0,i.jsx)(j.Z,{fullWidth:!0,label:"Distance",value:e.distance,onChange:e=>ei(a,"distance",e.target.value),margin:"normal",placeholder:"e.g. 350m dari Masjidil Haram"})}),(0,i.jsx)(v.ZP,{item:!0,xs:12,md:6,children:(0,i.jsx)(j.Z,{fullWidth:!0,label:"Map URL",value:e.mapUrl,onChange:e=>ei(a,"mapUrl",e.target.value),margin:"normal",placeholder:"e.g. https://maps.google.com/?q=Hotel+Name"})})]})]},"hotel-".concat(a))),(0,i.jsx)(Z.Z,{variant:"outlined",onClick:()=>{K(e=>({...e,hotels:[...e.hotels,{city:"",name:"",distance:"",rating:0,mapUrl:""}]}))},children:"Add Hotel"})]}),(0,i.jsxs)(W,{value:R,index:3,children:[null==z?void 0:null===(D=z.itinerary)||void 0===D?void 0:D.map((e,a)=>{var t;return(0,i.jsxs)(c.Z,{sx:{p:3,mb:3},children:[(0,i.jsxs)(n.Z,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:[(0,i.jsxs)(o.Z,{variant:"h6",children:["Day ",e.day]}),(0,i.jsx)(k.Z,{onClick:()=>ec(a),children:(0,i.jsx)(I.Z,{})})]}),(0,i.jsx)(j.Z,{fullWidth:!0,label:"Title",value:e.title,onChange:e=>el(a,"title",e.target.value),margin:"normal"}),(0,i.jsx)(j.Z,{fullWidth:!0,label:"Description",value:e.description,onChange:e=>el(a,"description",e.target.value),margin:"normal"}),null==e?void 0:null===(t=e.activities)||void 0===t?void 0:t.map((e,t)=>(0,i.jsxs)(n.Z,{sx:{display:"flex",alignItems:"center",mb:2},children:[(0,i.jsx)(j.Z,{fullWidth:!0,label:"Activity ".concat(t+1),value:e,onChange:e=>en(a,t,e.target.value),margin:"normal"}),(0,i.jsx)(k.Z,{onClick:()=>ed(a,t),children:(0,i.jsx)(I.Z,{})})]},"activity-".concat(t))),(0,i.jsx)(Z.Z,{variant:"outlined",onClick:()=>es(a),children:"Add Activity"})]},"day-".concat(a))}),(0,i.jsx)(Z.Z,{variant:"outlined",onClick:()=>{K(e=>{let a=e.itinerary.length>0?e.itinerary[e.itinerary.length-1].day:0;return{...e,itinerary:[...e.itinerary,{day:a+1,title:"",description:"",activities:[""]}]}})},children:"Add Itinerary Day"})]}),(0,i.jsx)(W,{value:R,index:4,children:(0,i.jsx)(j.Z,{fullWidth:!0,multiline:!0,rows:6,label:"Requirements & Terms",value:z.requirements,onChange:e=>K(a=>({...a,requirements:e.target.value.split("\n")})),margin:"normal",placeholder:"Enter all requirements and terms here..."})}),(0,i.jsxs)(W,{value:R,index:5,children:[null==z?void 0:null===(w=z.facilities)||void 0===w?void 0:w.map((e,a)=>(0,i.jsxs)(c.Z,{sx:{p:3,mb:3},children:[(0,i.jsxs)(n.Z,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:[(0,i.jsxs)(o.Z,{variant:"h6",children:["Facility ",a+1]}),(0,i.jsx)(k.Z,{onClick:()=>eu(a),children:(0,i.jsx)(I.Z,{})})]}),(0,i.jsx)(j.Z,{fullWidth:!0,label:"Title",value:e.title,onChange:e=>eo(a,"title",e.target.value),margin:"normal"}),(0,i.jsx)(j.Z,{fullWidth:!0,label:"Description",value:e.description,onChange:e=>eo(a,"description",e.target.value),margin:"normal"})]},"facility-".concat(a))),(0,i.jsx)(Z.Z,{variant:"outlined",onClick:()=>{K(e=>({...e,facilities:[...e.facilities,{title:"",description:""}]}))},children:"Add Facility"})]})]})]})})}function q(){let e=(0,l.useSearchParams)().get("id");return(0,i.jsxs)(v.ZP,{container:!0,spacing:6,children:[(0,i.jsx)(v.ZP,{item:!0,xs:12,children:(0,i.jsx)(o.Z,{variant:"h5",children:"Umrah Package details"})}),(0,i.jsx)(v.ZP,{item:!0,xs:12,className:"bg-white mt-10",children:(0,i.jsx)(U,{packageId:e})})]})}},73501:function(e,a,t){"use strict";let i=(0,t(15236).ZF)({apiKey:"AIzaSyCh-VbkFTAxPrY7lvEbaOd4i73lodoE4RQ",authDomain:"salamadina-fa1ca.firebaseapp.com",projectId:"salamadina-fa1ca",storageBucket:"salamadina-fa1ca.firebasestorage.app",messagingSenderId:"1025635284303",appId:"1:1025635284303:web:a19855074f12f54ffa413a"});a.Z=i},26457:function(e,a,t){"use strict";t.d(a,{p:function(){return n}});var i=t(69842),r=t(73501);let l=(0,i.ad)(r.Z),n={getPackages:async()=>{try{let e=(0,i.IO)((0,i.hJ)(l,"umrahPackages"),(0,i.Xo)("createdAt","desc")),a=await (0,i.PL)(e),t=[];return a.forEach(e=>{t.push({id:e.id,...e.data()})}),t}catch(e){throw console.error("Error fetching packages: ",e),Error("Failed to fetch packages")}},addPackage:async e=>{try{return(await (0,i.ET)((0,i.hJ)(l,"umrahPackages"),{...e,createdAt:i.EK.now()})).id}catch(e){throw console.error("Error adding package: ",e),Error("Failed to add package")}},updatePackage:async(e,a)=>{try{if(!e)throw Error("Package ID is required");let t=(0,i.JU)(l,"umrahPackages",e);console.log("Updating package ".concat(e," with data:"),a),await (0,i.r7)(t,{...a,updatedAt:i.EK.now()}),console.log("Package ".concat(e," updated successfully"))}catch(e){if(console.error("Error updating package: ",e),e instanceof Error)throw Error("Failed to update package: ".concat(e.message));throw Error("Failed to update package: Unknown error")}},deletePackage:async e=>{try{await (0,i.oe)((0,i.JU)(l,"umrahPackages",e))}catch(e){throw console.error("Error deleting package: ",e),Error("Failed to delete package")}}}}},function(e){e.O(0,[4358,5236,2173,808,5161,3834,9325,6951,6511,3983,5754,5159,2980,2971,7023,1744],function(){return e(e.s=19732)}),_N_E=e.O()}]);